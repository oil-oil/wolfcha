<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wolfcha - The Summoning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Dancing+Script:wght@600;700&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-blood: #8a1c1c;
            --color-blood-light: #b93636;
            --color-gold: #c5a059;
            --bg-dark: #1a1614;
            --paper: #f0e6d2;
            
            /* Game Card Colors */
            --surface-card: rgba(30, 25, 23, 0.6);
            --surface-border: rgba(255, 255, 255, 0.1);
            --text-primary: #f0e6d2;
            --text-muted: rgba(240, 230, 210, 0.6);
            --color-accent: #c5a059;
        }

        body {
            background-color: var(--bg-dark);
            font-family: 'Noto Serif SC', serif;
            overflow: hidden;
            height: 100vh;
            margin: 0;
            color: var(--text-primary);
        }

        .fog-container {
            position: absolute;
            inset: -50%;
            z-index: 0;
            pointer-events: none;
            background: 
                radial-gradient(circle at 50% 50%, rgba(138, 28, 28, 0.05), transparent 60%),
                radial-gradient(circle at 20% 30%, rgba(0, 0, 0, 0.4), transparent 50%);
            animation: fog-pulse 10s ease-in-out infinite alternate;
        }
        @keyframes fog-pulse {
            0% { opacity: 0.8; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.05); }
        }

        /* 布局容器 */
        .game-layout {
            position: fixed;
            inset: 0;
            display: flex;
            padding: 1.5rem;
            gap: 1rem;
            z-index: 10;
        }

        .side-panel {
            width: 220px;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            flex-shrink: 0;
            /* 预留空间但不显示内容 */
        }

        .center-stage {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            perspective: 1200px;
        }

        /* 契约书 */
        .paper-wrapper {
            position: relative;
            z-index: 20;
            transition: all 1s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .contract-paper {
            width: 440px;
            height: 600px;
            background-color: var(--paper);
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(138, 28, 28, 0.03), transparent 70%),
                url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.15'/%3E%3C/svg%3E");
            box-shadow: 
                0 20px 50px rgba(0,0,0,0.6),
                inset 0 0 80px rgba(139, 69, 19, 0.15);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }
        
        .mode-summoning .contract-paper {
            transform: scale(0.8) translateZ(-100px);
            opacity: 0.8;
            filter: blur(2px) grayscale(0.5);
            box-shadow: 0 0 100px rgba(138, 28, 28, 0.2);
        }

        .paper-border {
            position: absolute;
            inset: 10px;
            border: 2px solid rgba(44, 24, 16, 0.15);
            pointer-events: none;
        }
        .paper-border::after {
            content: "";
            position: absolute;
            inset: 4px;
            border: 1px solid rgba(44, 24, 16, 0.08);
        }

        .contract-content {
            position: absolute;
            inset: 0;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: opacity 0.5s ease;
        }
        
        .mode-summoning .contract-content {
            opacity: 0;
            pointer-events: none;
        }

        /* 召唤中心 */
        .summoning-center {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.8s ease 0.3s;
            pointer-events: none;
            z-index: 50;
        }

        .mode-summoning .summoning-center {
            opacity: 1;
        }

        /* 魔法阵 */
        .magic-circle {
            width: 360px;
            height: 360px;
            position: relative;
        }
        
        .magic-ring {
            position: absolute;
            inset: 0;
            border: 1px solid var(--color-blood);
            border-radius: 50%;
        }

        .mode-summoning .magic-ring:nth-child(1) { animation: spin 20s linear infinite; border-style: dashed; opacity: 0.6; }
        .mode-summoning .magic-ring:nth-child(2) { inset: 40px; animation: spin 15s linear infinite reverse; border-color: var(--color-gold); opacity: 0.4; }
        .mode-summoning .magic-ring:nth-child(3) { inset: 80px; border: 1px solid var(--color-blood); opacity: 0.2; transform: rotate(45deg); }
        
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* 飞行的卡片容器 */
        .flying-card-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        .flying-card {
            position: absolute;
            width: 220px;
            /* 保持与 player-card 一致的样式 */
            background-color: var(--surface-card);
            border: 1px solid var(--surface-border);
            border-radius: 0.75rem;
            padding: 0.625rem 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            backdrop-filter: blur(4px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transform-origin: center center;
            transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* 最终落位的卡片 */
        .player-card {
            background-color: var(--surface-card);
            border: 1px solid var(--surface-border);
            border-radius: 0.75rem;
            padding: 0.625rem 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
            opacity: 0; /* 初始隐藏，等飞行动画结束后显示 */
        }
        
        .player-card.visible {
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        
        .player-card.is-me {
            border-left: 4px solid var(--color-accent);
        }

        .avatar-wrapper {
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 9999px;
            position: relative;
            flex-shrink: 0;
        }

        .avatar-img {
            width: 100%;
            height: 100%;
            border-radius: 9999px;
            object-fit: cover;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .card-info {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .seat-row {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            margin-bottom: 0.125rem;
        }

        .seat-badge {
            font-size: 10px;
            font-weight: 600;
            color: rgba(255,255,255,0.55);
        }
        
        .me-badge {
            font-size: 10px;
            background-color: var(--color-accent);
            color: white;
            padding: 0.125rem 0.25rem;
            border-radius: 0.125rem;
            font-weight: 700;
            line-height: 1;
        }

        .player-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-style {
            font-size: 10px;
            color: rgba(255,255,255,0.45);
        }

        /* 印章 */
        .seal-wrapper {
            position: absolute;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            transition: all 0.8s ease;
            z-index: 30;
        }
        
        .mode-summoning .seal-wrapper {
            bottom: 50%;
            transform: translate(-50%, 50%) scale(0.5);
            opacity: 0;
            pointer-events: none;
        }

        .wax-seal {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #b93636, #8a1c1c 55%, #581010);
            box-shadow: 0 8px 20px rgba(0,0,0,0.35);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 4px solid rgba(138, 28, 28, 0.6);
            transition: all 0.3s ease;
        }

        .loading-text {
            font-family: 'Cinzel', serif;
            font-weight: 700;
            color: var(--color-blood);
            letter-spacing: 0.2em;
            text-transform: uppercase;
            font-size: 1.5rem;
            text-shadow: 0 2px 10px rgba(138, 28, 28, 0.4);
            margin-bottom: 0.5rem;
        }

    </style>
</head>
<body>

    <div class="fog-container"></div>
    <div class="flying-card-container" id="flying-container"></div>

    <div class="game-layout">
        <!-- 左侧玩家位 -->
        <div class="side-panel" id="panel-left"></div>

        <!-- 中间区域 -->
        <div class="center-stage">
            <div class="paper-wrapper" id="paper">
                <div class="contract-paper">
                    <div class="paper-border"></div>
                    
                    <div class="contract-content">
                        <div class="text-center mt-12 mb-8">
                            <i class="ph-fill ph-paw-print text-5xl text-[#8a1c1c] mb-6 opacity-80"></i>
                            <h1 class="text-4xl font-black tracking-widest uppercase font-[Cinzel] text-[#8a1c1c]">The Contract</h1>
                        </div>
                        <div class="w-full px-8 space-y-8 text-center flex-1">
                            <p class="font-serif italic text-base leading-loose opacity-70">
                                在此立誓，<br>
                                当红月升起之时，<br>
                                我将献上我的智慧与忠诚。
                            </p>
                            <div class="pt-8 w-full max-w-[280px] mx-auto">
                                <input type="text" id="signature" placeholder="Sign Your Name" 
                                    class="w-full h-16 text-3xl text-center bg-transparent border-b-2 border-[#8a1c1c]/30 outline-none text-[#8a1c1c] font-['Dancing_Script'] placeholder:text-[#8a1c1c]/30 focus:border-[#8a1c1c]/80 transition-colors"
                                    oninput="checkInput(this)" autocomplete="off">
                            </div>
                        </div>
                    </div>

                    <!-- 召唤中状态（魔法阵） -->
                    <div class="summoning-center">
                        <div class="magic-circle">
                            <div class="magic-ring"></div>
                            <div class="magic-ring"></div>
                            <div class="magic-ring"></div>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <i class="ph-fill ph-paw-print text-6xl text-[#8a1c1c] opacity-30 animate-pulse"></i>
                            </div>
                        </div>
                        <div class="absolute top-[65%] text-center">
                             <div class="loading-text">Summoning</div>
                             <div class="text-[#8a1c1c]/60 text-xs tracking-widest uppercase font-serif" id="summon-status">Connecting Soul Links...</div>
                        </div>
                    </div>

                </div>

                <!-- 印章 -->
                <div class="seal-wrapper" id="seal-wrapper">
                    <button class="wax-seal" id="seal-btn" disabled onclick="startSummoning()">
                        <i class="ph-fill ph-fingerprint text-4xl text-[#581010] opacity-60"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 右侧玩家位 -->
        <div class="side-panel" id="panel-right"></div>
    </div>

    <script>
        const paper = document.getElementById('paper');
        const sealBtn = document.getElementById('seal-btn');
        const panelLeft = document.getElementById('panel-left');
        const panelRight = document.getElementById('panel-right');
        const flyingContainer = document.getElementById('flying-container');
        const summonStatus = document.getElementById('summon-status');
        
        let myName = "";

        function checkInput(input) {
            if (input.value.trim().length > 0) {
                sealBtn.disabled = false;
                sealBtn.style.opacity = '1';
                sealBtn.style.filter = 'none';
                myName = input.value;
            } else {
                sealBtn.disabled = true;
                sealBtn.style.opacity = '0.6';
                sealBtn.style.filter = 'grayscale(1)';
            }
        }

        function startSummoning() {
            // 1. 点击印章
            sealBtn.style.transform = 'scale(0.9)';
            
            // 2. 状态切换
            setTimeout(() => {
                document.body.classList.add('mode-summoning');
                // 3. 开始模拟入场
                simulateJoining();
            }, 400);
        }

        const mockPlayers = [
            { name: "ShadowHunter", style: "激进派 | 逻辑流" },
            { name: "MoonWalker", style: "直觉派 | 煽动者" },
            { name: "SilentNight", style: "保守派 | 观察者" },
            { name: "CrimsonEye", style: "平衡派 | 控场者" },
            { name: "PaleGhost", style: "混乱派 | 搅局者" },
            { name: "DarkProphet", style: "逻辑派 | 预言家" },
            { name: "SilverFang", style: "激进派 | 冲锋者" },
            { name: "IronHeart", style: "保守派 | 守护者" },
            { name: "MysticRose", style: "平衡派 | 中庸者" }
        ];

        function simulateJoining() {
            // 我自己先入场（左1）
            setTimeout(() => {
                flyCardToSeat({ name: myName || "Me", style: "你" }, true, 1, panelLeft);
            }, 800);

            // 其他人陆续入场
            let currentLeft = 1;
            let currentRight = 0;

            mockPlayers.forEach((player, i) => {
                const isLeft = currentLeft < 5;
                const panel = isLeft ? panelLeft : panelRight;
                if (isLeft) currentLeft++; else currentRight++;
                const seatNum = isLeft ? currentLeft : 5 + currentRight;

                // 随机延迟
                const randomDelay = 1500 + (i * 800) + Math.random() * 400;
                
                setTimeout(() => {
                    flyCardToSeat(player, false, seatNum, panel);
                    summonStatus.innerText = `Summoning ${player.name}...`;
                }, randomDelay);
            });
            
            // 最后
            setTimeout(() => {
                 summonStatus.innerText = "All Souls Connected";
                 // 显示进入游戏按钮或者直接跳转的逻辑（这里仅演示）
            }, 10000);
        }

        function flyCardToSeat(player, isMe, seatNum, targetPanel) {
            // 1. 在目标位置创建不可见的占位卡片，用于获取最终坐标
            const placeholder = createCardHTML(player, isMe, seatNum);
            targetPanel.appendChild(placeholder);
            
            const destRect = placeholder.getBoundingClientRect();
            
            // 2. 在屏幕中心（魔法阵位置）创建一个飞行卡片
            const flyingCard = createCardHTML(player, isMe, seatNum);
            flyingCard.classList.remove('player-card'); // 移除布局类
            flyingCard.classList.add('flying-card');
            
            // 初始位置：屏幕中心
            const startX = window.innerWidth / 2 - 110; // card width/2
            const startY = window.innerHeight / 2 - 40;  // card height/2
            
            flyingCard.style.left = `${startX}px`;
            flyingCard.style.top = `${startY}px`;
            flyingCard.style.transform = 'scale(0) rotate(180deg)'; // 初始缩小旋转
            flyingCard.style.opacity = '0';
            
            flyingContainer.appendChild(flyingCard);
            
            // 3. 执行动画
            // 阶段1: 从中心蹦出来
            requestAnimationFrame(() => {
                flyingCard.style.opacity = '1';
                flyingCard.style.transform = 'scale(1.1) rotate(0deg)';
                
                // 阶段2: 飞向目标
                setTimeout(() => {
                    const deltaX = destRect.left - startX;
                    const deltaY = destRect.top - startY;
                    
                    flyingCard.style.transform = `translate(${deltaX}px, ${deltaY}px) scale(1)`;
                    
                    // 阶段3: 到达后消失，显示占位符
                    setTimeout(() => {
                        flyingCard.style.opacity = '0';
                        placeholder.classList.add('visible'); // 显示真正的卡片
                        
                        setTimeout(() => {
                            flyingCard.remove();
                        }, 500);
                    }, 800); // 飞行时间
                }, 400); // 蹦出来停留时间
            });
        }

        function createCardHTML(player, isMe, seatNum) {
            const card = document.createElement('div');
            card.className = `player-card ${isMe ? 'is-me' : ''}`;
            
            const seed = player.name;
            const colors = ['e8d5c4', 'd4e5d7', 'd5dce8', 'e8d4d9', 'ddd4e8'];
            const bg = colors[seed.length % colors.length];
            const avatarUrl = `https://api.dicebear.com/7.x/notionists/svg?seed=${encodeURIComponent(seed)}&backgroundColor=${bg}`;

            card.innerHTML = `
                <div class="avatar-wrapper">
                    <img src="${avatarUrl}" class="avatar-img" alt="${player.name}">
                </div>
                <div class="card-info">
                    <div class="seat-row">
                        <span class="seat-badge">${seatNum}号</span>
                        ${isMe ? '<span class="me-badge">YOU</span>' : ''}
                    </div>
                    <div class="player-name">${player.name}</div>
                    <div class="player-style">${player.style}</div>
                </div>
            `;
            return card;
        }

        // 视差
        document.addEventListener('mousemove', (e) => {
            if (document.body.classList.contains('mode-summoning')) return;
            const x = (window.innerWidth / 2 - e.pageX) / 60;
            const y = (window.innerHeight / 2 - e.pageY) / 60;
            const paper = document.querySelector('.contract-paper');
            if (paper) {
                paper.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
            }
        });
    </script>
</body>
</html>
